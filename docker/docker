FROM apache/spark:3.5.0

USER root

# Install Python dependencies
RUN pip install pyspark==3.5.0

# Pre-create the checkpoint directory (important for permissions!)
RUN mkdir -p /tmp/spark-checkpoints && chmod -R 777 /tmp/spark-checkpoints

# Create a directory for your code
WORKDIR /opt/spark/work-dir

# The Spark image already has a entrypoint, we just need to make sure 
# the jars are accessible or downloaded via spark-submit
